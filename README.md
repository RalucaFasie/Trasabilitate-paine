# Trasabilitate-paine — Blockchain Traceability System

[![CI](https://github.com/RalucaFasie/Trasabilitate-paine/actions/workflows/ci.yml/badge.svg)](https://github.com/RalucaFasie/Trasabilitate-paine/actions/workflows/ci.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)
[![Solidity](https://img.shields.io/badge/Solidity-0.8.20-blue)](https://soliditylang.org/)

A modern blockchain-based bread traceability system with smart contracts, relayer service, and an interactive web interface built with Vite.

## Features

- Interactive web interface for tracking bread from farm to consumer
- Smart contract registry (OpenZeppelin-based) with RELAYER role
- Backend relayer service for handling blockchain transactions
- Modern development workflow with Vite, ESLint, and Prettier
- QR code support for traceability verification

## Quick Start

### Running the Web Interface Locally

### 1. Install dependencies:
```bash
npm install
```

### 2. Start the development server:
```bash
npm run dev
```

The app will be available at http://localhost:5173

### 3. Build for production:
```bash
npm run build
```

This creates an optimized build in the `dist/` directory.

### 4. Preview production build:
```bash
npm run preview
```

## Development Commands

- `npm run dev` - Start Vite development server with hot reload
- `npm run build` - Build optimized production bundle
- `npm run preview` - Preview production build locally
- `npm run lint` - Run ESLint on source files
- `npm run format` - Format code with Prettier

## Blockchain Development

### 1. Configure environment (optional for demo):
```bash
cp .env.example .env
# Edit .env with your keys (optional for testnet)
```

### 2. Start Hardhat local node:
```bash
npm run node
```

### 3. Deploy contract locally (in a new terminal):
```bash
npm run deploy
```
**Important:** Note the contract address from output and set it in `.env` as `CONTRACT_ADDRESS=0x...`

### 4. Start relayer (mock mode is OK for demo):
```bash
npm run relayer
```
Relayer will run on http://localhost:3001 (mock mode if RELAYER_PK is not set)

### 5. Connect Metamask:
- Import one of the keys generated by Hardhat into Metamask
- Configure custom network: RPC URL = http://localhost:8545, Chain ID = 31337
- Use buttons in the interface:
  - **"Conectează Wallet"** - connect Metamask
  - **"Verifică pe blockchain"** - verify registered hashes
  - **"Export JSON"** - export traceability data

## GitHub Pages Deployment

To deploy the web interface to GitHub Pages:

1. Build the project: `npm run build`
2. The production files will be in the `dist/` directory
3. Configure GitHub Pages to serve from the `gh-pages` branch or use GitHub Actions to automatically deploy the `dist/` folder

### QR Codes
- SVG files are available in `public/assets/`: qr-b1.svg through qr-b5.svg
- These are placeholders containing block hashes
- For scannable QR codes, generate images with verification links (e.g., `https://your-demo.example/verify?hash=<hash>`) and replace the files in `public/assets/`

## Deploy to Testnet (Sepolia or Mumbai)

### 1. Configure .env with real keys:
```bash
PRIVATE_KEY=your_private_key_here
SEPOLIA_RPC=https://sepolia.infura.io/v3/YOUR_INFURA_KEY
# or
MUMBAI_RPC=https://rpc-mumbai.maticvigil.com
```

### 2. Deploy to testnet:
```bash
npm run deploy:sepolia
# or
npm run deploy:mumbai
```

### 3. Configure relayer for testnet:
```bash
RELAYER_PK=your_relayer_private_key
RPC_URL=https://sepolia.infura.io/v3/YOUR_INFURA_KEY
CONTRACT_ADDRESS=deployed_contract_address
npm run relayer
```

## Project Structure

```
├── .github/             # GitHub configurations
│   ├── workflows/       # CI/CD workflows
│   ├── ISSUE_TEMPLATE/  # Issue templates
│   └── pull_request_template.md
├── contracts/           # Solidity smart contracts
│   └── SimpleRegistry.sol
├── scripts/            # Deploy scripts
│   └── deploy.js
├── relayer/            # Backend relayer service
│   └── index.js
├── test/               # Contract tests
│   └── SimpleRegistry.test.js
├── public/             # Static assets (copied to dist during build)
│   └── assets/         # Images, QR codes, and other static files
├── src/                # Source code
│   ├── main.js         # Main JavaScript entry point
│   └── styles.css      # Application styles
├── index.html          # Main interface (Vite entry point)
├── verify.html         # Verification page
├── dist/               # Production build output (generated)
├── vite.config.js      # Vite configuration
├── .eslintrc.json      # ESLint configuration
├── .prettierrc         # Prettier configuration
├── hardhat.config.js   # Hardhat configuration
├── package.json        # Dependencies and npm scripts
├── CODE_OF_CONDUCT.md  # Contributor guidelines
├── SECURITY.md         # Security policy
└── CONTRIBUTING.md     # Development guidelines
```

## Technologies Used

- **Blockchain:** Solidity 0.8.20, Hardhat, OpenZeppelin
- **Backend:** Express.js, ethers.js v6
- **Frontend:** HTML5, CSS3, JavaScript (vanilla), Vite
- **Development Tools:** ESLint, Prettier
- **Network:** Ethereum-compatible (Hardhat local, Sepolia, Mumbai)